2025-12-15 23:14:00,903 | INFO     | logger_utils.py:init_logger:48 | Log file created at Fairness_Neuron_Repair/logs/stage1_bias_analysis.log. Console will show WARNING level messages and above (default).
2025-12-15 23:14:00,903 | INFO     | stage1_bias_analysis.py:main:347 | STAGE 1: BASELINE ANALYSIS AND BIAS DETECTION
2025-12-15 23:14:00,903 | INFO     | stage1_bias_analysis.py:main:348 | Process start time: 2025-12-15 23:14:00
2025-12-15 23:14:00,946 | INFO     | preprocess.py:preprocess_data_for_ml_models:99 | Preprocessing data for ML Network training
2025-12-15 23:14:00,946 | INFO     | preprocess.py:preprocess_data_for_ml_models:100 | Loading pre-split train/test data created by download_split_dataset_router
2025-12-15 23:14:00,985 | INFO     | preprocess.py:preprocess_data_for_ml_models:115 | Data loaded - Train: 24128, Test: 6032
2025-12-15 23:14:00,987 | INFO     | preprocess.py:preprocess_data_for_ml_models:131 | Initializing and fitting HyperTransformer on training features...
2025-12-15 23:14:01,310 | INFO     | preprocess.py:preprocess_data_for_ml_models:134 | HyperTransformer fitted successfully on training features
2025-12-15 23:14:01,316 | INFO     | preprocess.py:preprocess_data_for_ml_models:141 | HyperTransformer saved to: Fairness_Neuron_Repair/ml_models/adult/adult_train_hypertransformer.pkl
2025-12-15 23:14:01,316 | INFO     | preprocess.py:preprocess_data_for_ml_models:143 | Skipping sensitive attribute balancing for Fader Network to ensure consistent comparison with ML models.
2025-12-15 23:14:01,316 | INFO     | preprocess.py:preprocess_data_for_ml_models:144 | X_train length: 24128, column headers (original distribution): Index(['age', 'workclass', 'education', 'marital-status', 'occupation',
       'relationship', 'race', 'sex', 'capital-gain', 'capital-loss',
       'hours-per-week', 'native-country'],
      dtype='object')
2025-12-15 23:14:01,316 | INFO     | preprocess.py:preprocess_data_for_ml_models:147 | Loading existing HyperTransformer from ML training stage...
2025-12-15 23:14:01,323 | INFO     | preprocess.py:load_hypertransformer:44 | Successfully loaded HyperTransformer from: Fairness_Neuron_Repair/ml_models/adult/adult_train_hypertransformer.pkl
2025-12-15 23:14:01,323 | INFO     | preprocess.py:preprocess_data_for_ml_models:149 | Successfully loaded pre-trained HyperTransformer - no retraining needed
2025-12-15 23:14:01,333 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:14:01,336 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:14:01,337 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:14:01,613 | INFO     | preprocess.py:preprocess_data_for_ml_models:165 | X_train_transformed column headers: Index(['age', 'workclass.value0', 'workclass.value1', 'workclass.value2',
       'workclass.value3', 'workclass.value4', 'workclass.value5',
       'workclass.value6', 'education.value0', 'education.value1',
       ...
       'native-country.value31', 'native-country.value32',
       'native-country.value33', 'native-country.value34',
       'native-country.value35', 'native-country.value36',
       'native-country.value37', 'native-country.value38',
       'native-country.value39', 'native-country.value40'],
      dtype='object', length=102)
2025-12-15 23:14:01,812 | INFO     | stage1_bias_analysis.py:main:382 | Training data: 24128 samples
2025-12-15 23:14:01,815 | INFO     | stage1_bias_analysis.py:main:383 | Gender distribution - Training Data: {'Male': 16355, 'Female': 7773}
2025-12-15 23:14:01,815 | INFO     | stage1_bias_analysis.py:main:384 | Test data: 6032 samples
2025-12-15 23:14:02,999 | INFO     | stage1_bias_analysis.py:main:398 | 
Created DataLoader with 95 batches (batch_size=256)
2025-12-15 23:14:02,999 | INFO     | stage1_bias_analysis.py:main:401 | 
Training neural network...
2025-12-15 23:14:03,650 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 0, Average Loss: 0.401248
2025-12-15 23:14:13,388 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 20, Average Loss: 0.283353
2025-12-15 23:14:22,913 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 40, Average Loss: 0.243671
2025-12-15 23:14:32,584 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 60, Average Loss: 0.214322
2025-12-15 23:14:42,174 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 80, Average Loss: 0.179138
2025-12-15 23:14:51,882 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 100, Average Loss: 0.168385
2025-12-15 23:15:01,496 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 120, Average Loss: 0.158648
2025-12-15 23:15:11,206 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 140, Average Loss: 0.147044
2025-12-15 23:15:20,873 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 160, Average Loss: 0.150679
2025-12-15 23:15:30,608 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 180, Average Loss: 0.146699
2025-12-15 23:15:40,234 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 200, Average Loss: 0.136828
2025-12-15 23:15:49,984 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 220, Average Loss: 0.126682
2025-12-15 23:15:59,626 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 240, Average Loss: 0.139318
2025-12-15 23:16:09,377 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 260, Average Loss: 0.138920
2025-12-15 23:16:19,026 | INFO     | stage1_bias_analysis.py:train_model:125 | Epoch 280, Average Loss: 0.120657
2025-12-15 23:16:28,328 | INFO     | stage1_bias_analysis.py:main:407 | Model saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult__nn_stage1__.pth
2025-12-15 23:16:28,328 | INFO     | stage1_bias_analysis.py:main:410 | 
Extracting activations from layer3 (64 neurons)...
2025-12-15 23:16:28,412 | INFO     | stage1_bias_analysis.py:main:412 | Training activations shape: (24128, 64)
2025-12-15 23:16:28,432 | INFO     | stage1_bias_analysis.py:main:416 | Test activations shape: (6032, 64)
2025-12-15 23:16:28,432 | INFO     | stage1_bias_analysis.py:main:419 | 
Normalizing activations column-wise (per neuron) to [0, 1] range...
2025-12-15 23:16:28,441 | INFO     | stage1_bias_analysis.py:normalize_activations:156 | Normalized training activations: min per column = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], max per column = [ 2.712  3.899  3.061 11.661  6.495  7.434 12.121  2.214  6.026  3.132
  3.212  3.126  4.189  0.     2.316  3.014  6.086 13.463  4.697  0.
  7.932  5.621  0.     2.565  2.908  3.562  2.668  3.278  2.759  0.
  4.532 11.923  3.716  0.267  6.405  0.     2.689  3.172  2.237 11.903
  0.     2.284  4.453  5.569  0.     5.846  2.465  3.46   2.713  3.396
  5.534  7.272  2.577  6.729  3.779  2.777  5.731  4.208  0.     0.
  3.876  7.145  2.442  0.   ]
2025-12-15 23:16:28,442 | INFO     | stage1_bias_analysis.py:normalize_activations:160 | Normalized test activations using training min/max
2025-12-15 23:16:28,442 | INFO     | stage1_bias_analysis.py:main:422 | Normalized training activations shape: (24128, 64)
2025-12-15 23:16:28,442 | INFO     | stage1_bias_analysis.py:main:423 | Normalized test activations shape: (6032, 64)
2025-12-15 23:16:28,442 | INFO     | stage1_bias_analysis.py:main:426 | 
Training linear SVM to predict gender from normalized activations...
2025-12-15 23:16:28,448 | INFO     | stage1_bias_analysis.py:train_gender_classifier:182 | Gender distribution - Male (1): 16355, Female (0): 7773
2025-12-15 23:16:28,448 | INFO     | stage1_bias_analysis.py:train_gender_classifier:187 | Training SVM with class_weight='balanced' to penalize minority misclassification
2025-12-15 23:16:28,738 | INFO     | stage1_bias_analysis.py:train_gender_classifier:199 | Gender classifier training accuracy: 0.7871
2025-12-15 23:16:28,738 | INFO     | stage1_bias_analysis.py:train_gender_classifier:200 |  Training - Male accuracy: 0.8178
2025-12-15 23:16:28,738 | INFO     | stage1_bias_analysis.py:train_gender_classifier:201 |  Training - Female accuracy: 0.7226
2025-12-15 23:16:28,746 | INFO     | stage1_bias_analysis.py:main:438 | Gender classifier test accuracy: 0.7822
2025-12-15 23:16:28,746 | INFO     | stage1_bias_analysis.py:main:439 | Baseline (random): 0.5000
2025-12-15 23:16:28,746 | INFO     | stage1_bias_analysis.py:main:440 | Bias detected: Yes (threshold: 0.55)
2025-12-15 23:16:28,746 | INFO     | stage1_bias_analysis.py:main:443 | 
Identifying most biased neurons (Combined Importance: SVM_Coef * Output_Weight)...
2025-12-15 23:16:28,751 | INFO     | stage1_bias_analysis.py:identify_biased_neurons:222 | Absolute SVM coefficients: [ 2.89  14.76   2.464  7.034  1.714  4.904  5.066  5.025 10.445  5.563
  3.668  5.238  4.603  2.332 10.025  3.164  0.738  6.332 10.472  0.
  6.218  6.768  0.     5.067  8.115  0.345 13.28   1.159  3.492  0.
 10.035  6.269  3.083  4.06  20.697  0.     0.627  1.241  7.62   0.276
  0.     7.659 10.586  3.094  0.     1.714  3.347  1.243  4.305  2.556
 10.734  1.577  0.541  6.183  1.885  2.121 14.004  4.101  0.     0.
  4.613  8.759 10.397  0.   ]
2025-12-15 23:16:28,752 | INFO     | stage1_bias_analysis.py:identify_biased_neurons:223 | Absolute Model output weights: [0.955 0.8   0.905 1.733 1.074 1.245 1.687 0.867 0.836 0.959 0.96  0.992
 1.239 0.    0.901 0.945 1.076 1.648 0.824 0.012 1.021 0.785 0.    0.908
 1.013 0.989 0.755 0.962 0.946 0.    0.825 1.699 1.165 0.01  0.808 0.
 0.885 1.101 0.838 1.635 0.    0.812 0.823 0.778 0.    1.049 0.861 1.17
 0.935 1.017 0.928 1.095 0.919 1.181 1.067 0.928 1.004 0.797 0.    0.
 1.348 1.126 0.729 0.   ]
2025-12-15 23:16:28,753 | INFO     | stage1_bias_analysis.py:identify_biased_neurons:233 | Relative SVM coefficients: [0.608 3.105 0.518 1.48  0.361 1.032 1.066 1.057 2.197 1.17  0.772 1.102
 0.968 0.491 2.109 0.666 0.155 1.332 2.203 0.    1.308 1.424 0.    1.066
 1.707 0.073 2.794 0.244 0.735 0.    2.111 1.319 0.649 0.854 4.354 0.
 0.132 0.261 1.603 0.058 0.    1.611 2.227 0.651 0.    0.361 0.704 0.261
 0.906 0.538 2.258 0.332 0.114 1.301 0.397 0.446 2.946 0.863 0.    0.
 0.971 1.843 2.187 0.   ]
2025-12-15 23:16:28,754 | INFO     | stage1_bias_analysis.py:identify_biased_neurons:234 | Relative Model output weights: [1.12  0.938 1.061 2.033 1.259 1.46  1.978 1.017 0.98  1.125 1.126 1.164
 1.453 0.    1.057 1.108 1.261 1.933 0.967 0.015 1.197 0.921 0.    1.065
 1.188 1.16  0.886 1.128 1.11  0.    0.967 1.992 1.367 0.012 0.948 0.
 1.038 1.291 0.982 1.918 0.    0.952 0.965 0.912 0.    1.23  1.009 1.372
 1.096 1.193 1.089 1.284 1.078 1.386 1.251 1.089 1.177 0.934 0.    0.
 1.581 1.32  0.855 0.   ]
2025-12-15 23:16:28,756 | INFO     | stage1_bias_analysis.py:identify_biased_neurons:239 | importance for the dropout of the neurons: [0.681 2.913 0.55  3.008 0.454 1.507 2.108 1.075 2.154 1.316 0.869 1.282
 1.407 0.    2.23  0.738 0.196 2.575 2.13  0.    1.566 1.312 0.    1.135
 2.028 0.084 2.475 0.275 0.815 0.    2.042 2.628 0.886 0.01  4.128 0.
 0.137 0.337 1.575 0.111 0.    1.534 2.15  0.594 0.    0.443 0.711 0.359
 0.993 0.642 2.459 0.426 0.123 1.802 0.496 0.486 3.468 0.806 0.    0.
 1.535 2.433 1.87  0.   ]
2025-12-15 23:16:28,760 | INFO     | stage1_bias_analysis.py:main:451 | Biased neurons saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult_biased_neurons_stage1.csv
2025-12-15 23:16:28,760 | INFO     | stage1_bias_analysis.py:main:454 | 
Saving activations with gender labels...
2025-12-15 23:16:29,714 | INFO     | stage1_bias_analysis.py:main:462 | Training activations saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult_activations_train_stage1.csv
2025-12-15 23:16:29,937 | INFO     | stage1_bias_analysis.py:main:471 | Test activations saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult_activations_test_stage1.csv
2025-12-15 23:16:29,938 | INFO     | stage1_bias_analysis.py:main:477 | Gender classifier saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult_gender_classifier_stage1.pkl
2025-12-15 23:16:29,938 | INFO     | stage1_bias_analysis.py:main:486 | 
Evaluating income classification accuracy...
2025-12-15 23:16:29,939 | INFO     | stage1_bias_analysis.py:main:491 | Weights before reset : [ 0.955 -0.8    0.905 -1.733 -1.074 -1.245 -1.687  0.867 -0.836  0.959
  0.96   0.992  1.239 -0.     0.901  0.945 -1.076 -1.648 -0.824 -0.012
 -1.021 -0.785 -0.     0.908  1.013  0.989 -0.755  0.962  0.946  0.
 -0.825 -1.699  1.165 -0.01  -0.808  0.     0.885  1.101  0.838 -1.635
  0.     0.812 -0.823 -0.778  0.    -1.049  0.861  1.17   0.935  1.017
 -0.928 -1.095  0.919 -1.181  1.067  0.928 -1.004 -0.797  0.    -0.
  1.348 -1.126 -0.729  0.   ]
2025-12-15 23:16:29,939 | INFO     | stage1_bias_analysis.py:main:497 | Weights after reset : [ 0.955 -0.8    0.905 -1.733 -1.074 -1.245 -1.687  0.867 -0.836  0.959
  0.96   0.992  1.239 -0.     0.901  0.945 -1.076 -1.648 -0.824 -0.012
 -1.021 -0.785 -0.     0.908  1.013  0.989 -0.755  0.962  0.946  0.
 -0.825 -1.699  1.165 -0.01  -0.808  0.     0.885  1.101  0.838 -1.635
  0.     0.812 -0.823 -0.778  0.    -1.049  0.861  1.17   0.935  1.017
 -0.928 -1.095  0.919 -1.181  1.067  0.928 -1.004 -0.797  0.    -0.
  1.348 -1.126 -0.729  0.   ]
2025-12-15 23:16:29,942 | INFO     | stage1_bias_analysis.py:main:506 | Baseline - Probabilities > 0.5: 1389 instances, values: [0.5092 0.9984 0.6113 ... 1.     1.     0.6623]
2025-12-15 23:16:29,942 | INFO     | stage1_bias_analysis.py:main:507 | Baseline - Average probability for > 0.5: 0.8706
2025-12-15 23:16:29,942 | INFO     | stage1_bias_analysis.py:main:509 | Baseline - Probabilities < 0.5: 4643 instances, values: [0.1258 0.012  0.     ... 0.2532 0.     0.    ]
2025-12-15 23:16:29,942 | INFO     | stage1_bias_analysis.py:main:510 | Baseline - Average probability for < 0.5: 0.0504
2025-12-15 23:16:29,943 | INFO     | stage1_bias_analysis.py:main:515 | Income classification test accuracy: 0.8286
2025-12-15 23:16:29,943 | INFO     | stage1_bias_analysis.py:main:518 | BASELINE COUNTERFACTUAL DISCRIMINATION (No neurons masked)
2025-12-15 23:16:29,959 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:29,962 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:29,962 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:29,972 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:29,975 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:29,975 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:29,975 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:29,975 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:29,976 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:30,102 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:30,275 | INFO     | stage1_bias_analysis.py:main:524 | Income Classification Accuracy: 0.8286
2025-12-15 23:16:30,275 | INFO     | stage1_bias_analysis.py:main:525 | Counterfactual Discrimination:
2025-12-15 23:16:30,276 | INFO     | stage1_bias_analysis.py:main:526 |   Total: 819/6032 (13.58%)
2025-12-15 23:16:30,276 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 10 BIASED NEURONS MASKED
2025-12-15 23:16:30,276 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14]
2025-12-15 23:16:30,277 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:30,278 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:30,278 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [1. 0. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0. 1. 1. 1. 1. 1. 1.
 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 0. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1.]
2025-12-15 23:16:30,279 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 10: [0.   0.   0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.   0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.   0.06
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:30,279 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:30,281 | INFO     | stage1_bias_analysis.py:main:572 | Top 10 masked - Probabilities > 0.5: 1677 instances, values: [0.5163 0.803  0.9981 ... 1.     0.6873 0.5643]
2025-12-15 23:16:30,281 | INFO     | stage1_bias_analysis.py:main:573 | Top 10 masked - Average probability for > 0.5: 0.8738
2025-12-15 23:16:30,281 | INFO     | stage1_bias_analysis.py:main:575 | Top 10 masked - Probabilities < 0.5: 4355 instances, values: [7.020e-02 1.000e-04 0.000e+00 ... 3.104e-01 1.000e-04 0.000e+00]
2025-12-15 23:16:30,282 | INFO     | stage1_bias_analysis.py:main:576 | Top 10 masked - Average probability for < 0.5: 0.0704
2025-12-15 23:16:30,296 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:30,299 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:30,299 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:30,309 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:30,311 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:30,311 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:30,311 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:30,312 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:30,312 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:30,437 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:30,610 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.8143
2025-12-15 23:16:30,610 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:30,610 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 876/6032 (14.52%)
2025-12-15 23:16:30,610 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 20 BIASED NEURONS MASKED
2025-12-15 23:16:30,610 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20]
2025-12-15 23:16:30,611 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:30,612 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:30,612 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [1. 0. 1. 0. 1. 1. 0. 1. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0. 1. 1. 1.
 0. 1. 0. 1. 1. 1. 0. 0. 1. 1. 0. 1. 1. 1. 0. 1. 1. 1. 0. 1. 1. 1. 1. 1.
 1. 1. 0. 1. 1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 0. 1.]
2025-12-15 23:16:30,613 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 20: [0.   0.   0.04 0.   0.   0.   0.   0.06 0.   0.   0.   0.06 0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.06 0.   0.   0.   0.03 0.   0.06
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.03
 0.   0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.   0.  ]
2025-12-15 23:16:30,614 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:30,615 | INFO     | stage1_bias_analysis.py:main:572 | Top 20 masked - Probabilities > 0.5: 2036 instances, values: [0.5402 0.9436 0.9972 ... 1.     0.7062 0.8753]
2025-12-15 23:16:30,616 | INFO     | stage1_bias_analysis.py:main:573 | Top 20 masked - Average probability for > 0.5: 0.8648
2025-12-15 23:16:30,616 | INFO     | stage1_bias_analysis.py:main:575 | Top 20 masked - Probabilities < 0.5: 3996 instances, values: [0.1885 0.0046 0.0007 ... 0.3989 0.0068 0.    ]
2025-12-15 23:16:30,616 | INFO     | stage1_bias_analysis.py:main:576 | Top 20 masked - Average probability for < 0.5: 0.0980
2025-12-15 23:16:30,631 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:30,634 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:30,634 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:30,644 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:30,646 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:30,646 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:30,646 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:30,647 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:30,647 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:30,773 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:30,925 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.7886
2025-12-15 23:16:30,925 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:30,925 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 910/6032 (15.09%)
2025-12-15 23:16:30,925 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 30 BIASED NEURONS MASKED
2025-12-15 23:16:30,925 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48]
2025-12-15 23:16:30,927 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:30,927 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:30,948 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 1. 1. 0. 0. 1. 0. 0. 1. 0.
 0. 1. 0. 1. 1. 1. 0. 0. 1. 1. 0. 1. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 1. 1.
 0. 1. 0. 1. 1. 0. 1. 1. 0. 1. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:30,949 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 30: [0.   0.   0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.03 0.   0.06
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.05 0.   0.   0.06 0.   0.   0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.   0.  ]
2025-12-15 23:16:30,950 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:30,952 | INFO     | stage1_bias_analysis.py:main:572 | Top 30 masked - Probabilities > 0.5: 1871 instances, values: [0.5058 0.843  0.9791 ... 1.     0.6466 0.7135]
2025-12-15 23:16:30,952 | INFO     | stage1_bias_analysis.py:main:573 | Top 30 masked - Average probability for > 0.5: 0.8269
2025-12-15 23:16:30,952 | INFO     | stage1_bias_analysis.py:main:575 | Top 30 masked - Probabilities < 0.5: 4161 instances, values: [0.2371 0.0129 0.0031 ... 0.424  0.0183 0.    ]
2025-12-15 23:16:30,952 | INFO     | stage1_bias_analysis.py:main:576 | Top 30 masked - Average probability for < 0.5: 0.1203
2025-12-15 23:16:30,966 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:30,969 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:30,969 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:30,979 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:30,981 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:30,981 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:30,981 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:30,982 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:30,982 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:31,106 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:31,278 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.7994
2025-12-15 23:16:31,279 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:31,279 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 905/6032 (15.00%)
2025-12-15 23:16:31,279 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 40 BIASED NEURONS MASKED
2025-12-15 23:16:31,279 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2]
2025-12-15 23:16:31,280 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:31,281 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:31,281 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 1. 0. 0. 1. 0.
 0. 1. 0. 1. 0. 1. 0. 0. 0. 1. 0. 1. 1. 1. 0. 1. 1. 0. 0. 0. 1. 1. 0. 1.
 0. 0. 0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:31,283 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 40: [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.03 0.   0.06
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.  ]
2025-12-15 23:16:31,283 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:31,285 | INFO     | stage1_bias_analysis.py:main:572 | Top 40 masked - Probabilities > 0.5: 1540 instances, values: [0.5009 0.8701 0.534  ... 0.9895 0.9999 0.5776]
2025-12-15 23:16:31,285 | INFO     | stage1_bias_analysis.py:main:573 | Top 40 masked - Average probability for > 0.5: 0.7454
2025-12-15 23:16:31,285 | INFO     | stage1_bias_analysis.py:main:575 | Top 40 masked - Probabilities < 0.5: 4492 instances, values: [0.4865 0.2865 0.0237 ... 0.4789 0.033  0.    ]
2025-12-15 23:16:31,285 | INFO     | stage1_bias_analysis.py:main:576 | Top 40 masked - Average probability for < 0.5: 0.1397
2025-12-15 23:16:31,299 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:31,302 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:31,302 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:31,312 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:31,314 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:31,314 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:31,314 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:31,315 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:31,316 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:31,439 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:31,591 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.8205
2025-12-15 23:16:31,591 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:31,591 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 853/6032 (14.14%)
2025-12-15 23:16:31,591 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 45 BIASED NEURONS MASKED
2025-12-15 23:16:31,591 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51]
2025-12-15 23:16:31,613 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:31,614 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:31,614 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 1. 0. 0. 1. 0.
 0. 1. 0. 1. 0. 1. 0. 0. 0. 1. 0. 1. 1. 1. 0. 1. 1. 0. 0. 0. 1. 0. 0. 1.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:31,616 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 45: [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.03 0.   0.06
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.  ]
2025-12-15 23:16:31,616 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:31,618 | INFO     | stage1_bias_analysis.py:main:572 | Top 45 masked - Probabilities > 0.5: 1705 instances, values: [0.5009 0.6171 0.7951 ... 0.973  0.999  0.5457]
2025-12-15 23:16:31,618 | INFO     | stage1_bias_analysis.py:main:573 | Top 45 masked - Average probability for > 0.5: 0.7145
2025-12-15 23:16:31,618 | INFO     | stage1_bias_analysis.py:main:575 | Top 45 masked - Probabilities < 0.5: 4327 instances, values: [0.3577 0.1093 0.0596 ... 0.4789 0.1338 0.0034]
2025-12-15 23:16:31,618 | INFO     | stage1_bias_analysis.py:main:576 | Top 45 masked - Average probability for < 0.5: 0.1959
2025-12-15 23:16:31,633 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:31,635 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:31,635 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:31,645 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:31,647 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:31,647 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:31,647 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:31,648 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:31,649 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:31,774 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:31,946 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.8094
2025-12-15 23:16:31,946 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:31,946 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 872/6032 (14.46%)
2025-12-15 23:16:31,946 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 50 BIASED NEURONS MASKED
2025-12-15 23:16:31,947 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36]
2025-12-15 23:16:31,948 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:31,949 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:31,950 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0.
 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:31,951 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 50: [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.03 0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
 0.   0.   0.   0.   0.   0.   0.   0.  ]
2025-12-15 23:16:31,951 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0.]
2025-12-15 23:16:31,953 | INFO     | stage1_bias_analysis.py:main:572 | Top 50 masked - Probabilities > 0.5: 1025 instances, values: [0.5911 0.5074 0.5474 ... 0.6776 0.8889 0.5035]
2025-12-15 23:16:31,953 | INFO     | stage1_bias_analysis.py:main:573 | Top 50 masked - Average probability for > 0.5: 0.6247
2025-12-15 23:16:31,953 | INFO     | stage1_bias_analysis.py:main:575 | Top 50 masked - Probabilities < 0.5: 5007 instances, values: [0.4868 0.4489 0.3725 ... 0.4789 0.1985 0.0126]
2025-12-15 23:16:31,953 | INFO     | stage1_bias_analysis.py:main:576 | Top 50 masked - Average probability for < 0.5: 0.2452
2025-12-15 23:16:31,968 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:31,970 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:31,970 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:31,980 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:31,982 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:31,982 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:31,982 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:31,983 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:31,984 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:32,106 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:32,279 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.8249
2025-12-15 23:16:32,279 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:32,279 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 689/6032 (11.42%)
2025-12-15 23:16:32,279 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 54 BIASED NEURONS MASKED
2025-12-15 23:16:32,279 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33]
2025-12-15 23:16:32,280 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:32,281 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:32,282 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 1. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:32,283 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 54: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:32,283 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:32,285 | INFO     | stage1_bias_analysis.py:main:575 | Top 54 masked - Probabilities < 0.5: 6032 instances, values: [0.4789 0.4789 0.4789 ... 0.4789 0.4789 0.4789]
2025-12-15 23:16:32,285 | INFO     | stage1_bias_analysis.py:main:576 | Top 54 masked - Average probability for < 0.5: 0.4789
2025-12-15 23:16:32,300 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:32,302 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:32,302 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:32,312 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:32,314 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:32,314 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:32,314 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:32,315 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:32,315 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:32,438 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:32,610 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.7512
2025-12-15 23:16:32,611 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:32,611 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 0/6032 (0.00%)
2025-12-15 23:16:32,611 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 58 BIASED NEURONS MASKED
2025-12-15 23:16:32,611 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19]
2025-12-15 23:16:32,612 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:32,613 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:32,614 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:32,615 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 58: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:32,615 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:32,617 | INFO     | stage1_bias_analysis.py:main:575 | Top 58 masked - Probabilities < 0.5: 6032 instances, values: [0.4789 0.4789 0.4789 ... 0.4789 0.4789 0.4789]
2025-12-15 23:16:32,617 | INFO     | stage1_bias_analysis.py:main:576 | Top 58 masked - Average probability for < 0.5: 0.4789
2025-12-15 23:16:32,632 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:32,634 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:32,634 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:32,644 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:32,646 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:32,646 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:32,646 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:32,647 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:32,648 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:32,771 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:32,923 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.7512
2025-12-15 23:16:32,923 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:32,923 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 0/6032 (0.00%)
2025-12-15 23:16:32,923 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 60 BIASED NEURONS MASKED
2025-12-15 23:16:32,923 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19, 35, 22]
2025-12-15 23:16:32,945 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:32,946 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19, 35, 22] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:32,947 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:32,948 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 60: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:32,948 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19, 35, 22]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:32,950 | INFO     | stage1_bias_analysis.py:main:575 | Top 60 masked - Probabilities < 0.5: 6032 instances, values: [0.4789 0.4789 0.4789 ... 0.4789 0.4789 0.4789]
2025-12-15 23:16:32,950 | INFO     | stage1_bias_analysis.py:main:576 | Top 60 masked - Average probability for < 0.5: 0.4789
2025-12-15 23:16:32,964 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:32,967 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:32,967 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:32,977 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:32,979 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:32,979 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:32,979 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:32,980 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:32,980 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:33,103 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:33,255 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.7512
2025-12-15 23:16:33,255 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:33,255 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 0/6032 (0.00%)
2025-12-15 23:16:33,255 | INFO     | stage1_bias_analysis.py:main:538 | METRICS WITH TOP 62 BIASED NEURONS MASKED
2025-12-15 23:16:33,255 | INFO     | stage1_bias_analysis.py:main:541 | Neurons masked: [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19, 35, 22]
2025-12-15 23:16:33,277 | INFO     | stage1_bias_analysis.py:main:551 | Activations (first row) BEFORE masking: [0.   0.04 0.04 0.   0.   0.   0.   0.06 0.04 0.   0.   0.06 0.   0.
 0.06 0.   0.   0.   0.01 0.   0.   0.06 0.   0.   0.   0.03 0.04 0.06
 0.   0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.   0.   0.03
 0.04 0.05 0.   0.   0.06 0.   0.06 0.03 0.   0.   0.   0.   0.   0.
 0.   0.06 0.   0.   0.   0.   0.02 0.  ]
2025-12-15 23:16:33,278 | INFO     | stage1_bias_analysis.py:set_neuron_mask:93 | Neuron mask after setting indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19, 35, 22] to [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]:
2025-12-15 23:16:33,278 | INFO     | stage1_bias_analysis.py:set_neuron_mask:94 | Mask values: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1.]
2025-12-15 23:16:33,279 | INFO     | stage1_bias_analysis.py:main:559 | Activations (first row) AFTER masking top 62: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:33,280 | INFO     | stage1_bias_analysis.py:main:563 | Values at masked indices [34, 56, 3, 1, 31, 17, 26, 50, 61, 14, 8, 42, 18, 6, 30, 24, 62, 53, 38, 20, 60, 41, 5, 12, 9, 21, 11, 23, 7, 48, 32, 10, 28, 57, 15, 46, 0, 49, 43, 2, 54, 55, 4, 45, 51, 47, 37, 27, 16, 36, 52, 39, 25, 33, 13, 44, 40, 19, 35, 22]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2025-12-15 23:16:33,281 | INFO     | stage1_bias_analysis.py:main:575 | Top 62 masked - Probabilities < 0.5: 6032 instances, values: [0.4789 0.4789 0.4789 ... 0.4789 0.4789 0.4789]
2025-12-15 23:16:33,282 | INFO     | stage1_bias_analysis.py:main:576 | Top 62 masked - Average probability for < 0.5: 0.4789
2025-12-15 23:16:33,296 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:33,299 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:33,299 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:33,309 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-15 23:16:33,311 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-15 23:16:33,311 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-15 23:16:33,311 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:288 | Dummy indices match: [6032, 6033]
2025-12-15 23:16:33,312 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:293 | First instance of x_test_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                             Male
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:33,312 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:294 | First instance of x_test_cf_patched: age                               30
workclass                    Private
education                  Bachelors
marital-status    Married-civ-spouse
occupation           Exec-managerial
relationship                 Husband
race                           White
sex                           Female
capital-gain                       0
capital-loss                       0
hours-per-week                    50
native-country         United-States
Name: 0, dtype: object
2025-12-15 23:16:33,436 | INFO     | stage1_bias_analysis.py:calculate_counterfactual_discrimination:304 | Dropped 2 dummy rows from both original and counterfactual data
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:583 | Income Classification Accuracy: 0.7512
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:584 | Counterfactual Discrimination:
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:585 |   Total: 0/6032 (0.00%)
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:593 | STAGE 1 SUMMARY
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:594 | Income classification accuracy (baseline): 0.8286
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 10 masked): 0.8143
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 20 masked): 0.7886
2025-12-15 23:16:33,587 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 30 masked): 0.7994
2025-12-15 23:16:33,588 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 40 masked): 0.8205
2025-12-15 23:16:33,588 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 45 masked): 0.8094
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 50 masked): 0.8249
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 54 masked): 0.7512
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 58 masked): 0.7512
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 60 masked): 0.7512
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:598 | Income classification accuracy (top 62 masked): 0.7512
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:600 | Counterfactual discrimination (baseline): 819/6032 (13.58%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 10 masked): 876/6032 (14.52%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 20 masked): 910/6032 (15.09%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 30 masked): 905/6032 (15.00%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 40 masked): 853/6032 (14.14%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 45 masked): 872/6032 (14.46%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 50 masked): 689/6032 (11.42%)
2025-12-15 23:16:33,608 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 54 masked): 0/6032 (0.00%)
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 58 masked): 0/6032 (0.00%)
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 60 masked): 0/6032 (0.00%)
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:604 | Counterfactual discrimination (top 62 masked): 0/6032 (0.00%)
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:606 | Gender classification from activations (train): 0.7871
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:607 | Gender classification from activations (test): 0.7822
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:608 | Number of biased neurons identified: 60
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:615 | Process end time: 2025-12-15 23:16:33
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:616 | Total execution time: 2 minutes 32 seconds (152.71 seconds)
2025-12-15 23:16:33,609 | INFO     | stage1_bias_analysis.py:main:617 | ================================================================================
