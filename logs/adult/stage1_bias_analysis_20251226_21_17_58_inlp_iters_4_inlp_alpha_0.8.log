2025-12-26 21:17:58,917 | INFO     | logger_utils.py:init_logger:48 | Log file created at Fairness_Neuron_Repair/logs/adult/stage1_bias_analysis_20251226_21_17_58_inlp_iters_4_inlp_alpha_0.8.log. Console will show WARNING level messages and above (default).
2025-12-26 21:17:58,917 | INFO     | stage1_bias_analysis.py:main:357 | STAGE 1: BIAS ANALYSIS AND INLP REPAIR
2025-12-26 21:17:58,917 | INFO     | stage1_bias_analysis.py:main:358 | Process start time: 2025-12-26 21:17:58
2025-12-26 21:17:59,023 | INFO     | preprocess.py:preprocess_data_for_ml_models:99 | Preprocessing data for ML Network training
2025-12-26 21:17:59,024 | INFO     | preprocess.py:preprocess_data_for_ml_models:100 | Loading pre-split train/test data created by download_split_dataset_router
2025-12-26 21:17:59,106 | INFO     | preprocess.py:preprocess_data_for_ml_models:115 | Data loaded - Train: 24128, Test: 6032
2025-12-26 21:17:59,129 | INFO     | preprocess.py:preprocess_data_for_ml_models:131 | Initializing and fitting HyperTransformer on training features...
2025-12-26 21:17:59,910 | INFO     | preprocess.py:preprocess_data_for_ml_models:134 | HyperTransformer fitted successfully on training features
2025-12-26 21:17:59,916 | INFO     | preprocess.py:preprocess_data_for_ml_models:141 | HyperTransformer saved to: Fairness_Neuron_Repair/ml_models/adult/adult_train_hypertransformer.pkl
2025-12-26 21:17:59,916 | INFO     | preprocess.py:preprocess_data_for_ml_models:143 | Skipping sensitive attribute balancing for Fader Network to ensure consistent comparison with ML models.
2025-12-26 21:17:59,916 | INFO     | preprocess.py:preprocess_data_for_ml_models:144 | X_train length: 24128, column headers (original distribution): Index(['age', 'workclass', 'education', 'marital-status', 'occupation',
       'relationship', 'race', 'sex', 'capital-gain', 'capital-loss',
       'hours-per-week', 'native-country'],
      dtype='object')
2025-12-26 21:17:59,916 | INFO     | preprocess.py:preprocess_data_for_ml_models:147 | Loading existing HyperTransformer from ML training stage...
2025-12-26 21:17:59,943 | INFO     | preprocess.py:load_hypertransformer:44 | Successfully loaded HyperTransformer from: Fairness_Neuron_Repair/ml_models/adult/adult_train_hypertransformer.pkl
2025-12-26 21:17:59,943 | INFO     | preprocess.py:preprocess_data_for_ml_models:149 | Successfully loaded pre-trained HyperTransformer - no retraining needed
2025-12-26 21:17:59,974 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-26 21:17:59,978 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-26 21:17:59,978 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-26 21:18:00,620 | INFO     | preprocess.py:preprocess_data_for_ml_models:165 | X_train_transformed column headers: Index(['age', 'workclass.value0', 'workclass.value1', 'workclass.value2',
       'workclass.value3', 'workclass.value4', 'workclass.value5',
       'workclass.value6', 'education.value0', 'education.value1',
       ...
       'native-country.value31', 'native-country.value32',
       'native-country.value33', 'native-country.value34',
       'native-country.value35', 'native-country.value36',
       'native-country.value37', 'native-country.value38',
       'native-country.value39', 'native-country.value40'],
      dtype='object', length=102)
2025-12-26 21:18:00,895 | INFO     | stage1_bias_analysis.py:main:388 | Training data: 24128 samples
2025-12-26 21:18:00,897 | INFO     | stage1_bias_analysis.py:main:389 | Gender distribution (Train): {'Male': 16355, 'Female': 7773}
2025-12-26 21:18:00,900 | INFO     | stage1_bias_analysis.py:main:423 | 
Data split: 20509 training samples, 3619 validation samples
2025-12-26 21:18:00,900 | INFO     | stage1_bias_analysis.py:main:424 | Created DataLoaders: 81 train batches, 15 val batches (batch_size=256)
2025-12-26 21:18:00,925 | INFO     | stage1_bias_analysis.py:main:430 | Class distribution: Class 0=18122, Class 1=6006, pos_weight=3.0173
2025-12-26 21:18:03,888 | INFO     | stage1_bias_analysis.py:main:437 | 
Training neural network (Baseline) for fixed epochs with validation monitoring...
2025-12-26 21:18:05,263 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch   0 | Train Loss: 0.820655 | Val Loss: 0.643449
2025-12-26 21:18:06,144 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   1 | New best validation loss: 0.601436
2025-12-26 21:18:06,978 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   2 | New best validation loss: 0.591415
2025-12-26 21:18:07,883 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   3 | New best validation loss: 0.584056
2025-12-26 21:18:08,761 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   4 | New best validation loss: 0.577487
2025-12-26 21:18:10,005 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   5 | New best validation loss: 0.573332
2025-12-26 21:18:10,895 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   6 | New best validation loss: 0.570819
2025-12-26 21:18:11,789 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   7 | New best validation loss: 0.569406
2025-12-26 21:18:12,690 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   8 | New best validation loss: 0.568271
2025-12-26 21:18:13,578 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch   9 | New best validation loss: 0.567507
2025-12-26 21:18:14,458 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  10 | New best validation loss: 0.567078
2025-12-26 21:18:15,337 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  11 | New best validation loss: 0.566790
2025-12-26 21:18:16,216 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  12 | New best validation loss: 0.566424
2025-12-26 21:18:17,113 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  13 | New best validation loss: 0.566312
2025-12-26 21:18:17,987 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  14 | New best validation loss: 0.566063
2025-12-26 21:18:18,856 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  15 | New best validation loss: 0.565894
2025-12-26 21:18:19,751 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  16 | New best validation loss: 0.565758
2025-12-26 21:18:23,643 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch  20 | Train Loss: 0.560421 | Val Loss: 0.565707
2025-12-26 21:18:41,676 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch  40 | Train Loss: 0.555379 | Val Loss: 0.566489
2025-12-26 21:18:48,295 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  47 | New best validation loss: 0.565397
2025-12-26 21:18:51,874 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  51 | New best validation loss: 0.565193
2025-12-26 21:18:52,772 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  52 | New best validation loss: 0.564943
2025-12-26 21:18:55,460 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  55 | New best validation loss: 0.564630
2025-12-26 21:18:57,244 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  57 | New best validation loss: 0.564394
2025-12-26 21:18:59,319 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  59 | New best validation loss: 0.564288
2025-12-26 21:19:00,225 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch  60 | Train Loss: 0.552336 | Val Loss: 0.564138
2025-12-26 21:19:01,121 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  61 | New best validation loss: 0.563900
2025-12-26 21:19:02,898 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  63 | New best validation loss: 0.563709
2025-12-26 21:19:06,496 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  67 | New best validation loss: 0.563435
2025-12-26 21:19:07,386 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  68 | New best validation loss: 0.563193
2025-12-26 21:19:09,174 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  70 | New best validation loss: 0.563041
2025-12-26 21:19:11,262 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  72 | New best validation loss: 0.562878
2025-12-26 21:19:13,058 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  74 | New best validation loss: 0.562657
2025-12-26 21:19:13,951 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  75 | New best validation loss: 0.562515
2025-12-26 21:19:14,840 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  76 | New best validation loss: 0.562407
2025-12-26 21:19:15,749 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  77 | New best validation loss: 0.562328
2025-12-26 21:19:17,557 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  79 | New best validation loss: 0.562169
2025-12-26 21:19:18,444 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch  80 | Train Loss: 0.550147 | Val Loss: 0.562087
2025-12-26 21:19:20,235 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  82 | New best validation loss: 0.561974
2025-12-26 21:19:24,131 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  86 | New best validation loss: 0.561904
2025-12-26 21:19:25,929 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  88 | New best validation loss: 0.561529
2025-12-26 21:19:28,634 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  91 | New best validation loss: 0.561422
2025-12-26 21:19:29,549 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  92 | New best validation loss: 0.561157
2025-12-26 21:19:31,337 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  94 | New best validation loss: 0.561082
2025-12-26 21:19:33,162 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch  96 | New best validation loss: 0.560935
2025-12-26 21:19:37,095 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch 100 | Train Loss: 0.548548 | Val Loss: 0.560955
2025-12-26 21:19:40,710 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 104 | New best validation loss: 0.560759
2025-12-26 21:19:44,311 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 108 | New best validation loss: 0.560698
2025-12-26 21:19:48,231 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 112 | New best validation loss: 0.560447
2025-12-26 21:19:51,878 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 116 | New best validation loss: 0.560335
2025-12-26 21:19:54,591 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 119 | New best validation loss: 0.560234
2025-12-26 21:19:55,471 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch 120 | Train Loss: 0.547202 | Val Loss: 0.560321
2025-12-26 21:19:59,410 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 124 | New best validation loss: 0.560079
2025-12-26 21:20:11,495 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 137 | New best validation loss: 0.559924
2025-12-26 21:20:14,237 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch 140 | Train Loss: 0.546220 | Val Loss: 0.560119
2025-12-26 21:20:16,059 | INFO     | stage1_bias_analysis.py:train_model:154 | Epoch 142 | New best validation loss: 0.559855
2025-12-26 21:20:32,710 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch 160 | Train Loss: 0.545439 | Val Loss: 0.560565
2025-12-26 21:20:51,562 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch 180 | Train Loss: 0.544628 | Val Loss: 0.561569
2025-12-26 21:21:05,802 | INFO     | stage1_bias_analysis.py:train_model:145 | Epoch 199 | Train Loss: 0.544029 | Val Loss: 0.561177
2025-12-26 21:21:05,803 | INFO     | stage1_bias_analysis.py:train_model:159 | Restored best model from epoch 142 with validation loss: 0.559855
2025-12-26 21:21:05,803 | INFO     | stage1_bias_analysis.py:main:443 | Training completed. Best validation loss: 0.559855
2025-12-26 21:21:05,805 | INFO     | stage1_bias_analysis.py:main:448 | Original Model saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult__nn_stage1_original__20251226_21_17_58.pth
2025-12-26 21:21:05,805 | INFO     | stage1_bias_analysis.py:main:453 | 
--- BASELINE EVALUATION (Before Surgery) ---
2025-12-26 21:21:05,812 | INFO     | stage1_bias_analysis.py:main:469 | Baseline Income Accuracy: 83.0073%
2025-12-26 21:21:05,812 | INFO     | stage1_bias_analysis.py:main:478 | Baseline Accuracy (Class 0): 83.3591% (4531 samples)
2025-12-26 21:21:05,813 | INFO     | stage1_bias_analysis.py:main:481 | Baseline Accuracy (Class 1): 81.9454% (1501 samples)
2025-12-26 21:21:05,830 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-26 21:21:05,833 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-26 21:21:05,833 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-26 21:21:05,844 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-26 21:21:05,847 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-26 21:21:05,847 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-26 21:21:06,194 | INFO     | stage1_bias_analysis.py:main:492 | Baseline Counterfactual Discrimination: 613/6032 (10.16%)
2025-12-26 21:21:06,195 | INFO     | stage1_bias_analysis.py:main:501 | Baseline AOD: 0.130832
2025-12-26 21:21:06,195 | INFO     | stage1_bias_analysis.py:main:502 | Baseline EOD: 0.088828
2025-12-26 21:21:06,195 | INFO     | stage1_bias_analysis.py:main:507 | 
--- STARTING INLP PROCESS ---
2025-12-26 21:21:06,195 | INFO     | stage1_bias_analysis.py:main:510 | Extracting raw activations from layer 3...
2025-12-26 21:21:06,309 | INFO     | stage1_bias_analysis.py:main:515 | 
--- Activation Statistics (Before Projection) ---
2025-12-26 21:21:06,309 | INFO     | stage1_bias_analysis.py:main:516 | Train activations shape: (24128, 64)
2025-12-26 21:21:06,312 | INFO     | stage1_bias_analysis.py:main:517 | Train activations - Mean: 0.230367, Std: 0.233403
2025-12-26 21:21:06,312 | INFO     | stage1_bias_analysis.py:main:518 | Train activations - L2 norm: 407.518372
2025-12-26 21:21:06,313 | INFO     | stage1_bias_analysis.py:main:519 | Train activations - Min: 0.000000, Max: 1.550139
2025-12-26 21:21:06,313 | INFO     | stage1_bias_analysis.py:main:520 | Test activations shape: (6032, 64)
2025-12-26 21:21:06,314 | INFO     | stage1_bias_analysis.py:main:521 | Test activations - Mean: 0.231190, Std: 0.235819
2025-12-26 21:21:06,314 | INFO     | stage1_bias_analysis.py:main:522 | Test activations - L2 norm: 205.187912
2025-12-26 21:21:06,314 | INFO     | stage1_bias_analysis.py:main:523 | ================================================================================
2025-12-26 21:21:06,317 | INFO     | stage1_bias_analysis.py:main:536 | Computing Projection Matrix (P) and Training Gender SVM...
2025-12-26 21:21:06,317 | INFO     | stage1_bias_analysis.py:main:537 | Using same validation set as NN training: 20509 train, 3619 val
2025-12-26 21:21:06,319 | INFO     | inlp_core.py:get_projection_and_svm:19 | Training Initial Gender Detector (SVM)...
2025-12-26 21:21:06,493 | INFO     | inlp_core.py:get_projection_and_svm:31 | Using validation set: 20509 train, 3619 val
2025-12-26 21:21:06,494 | INFO     | inlp_core.py:get_projection_and_svm:33 | Starting INLP (n_iter=4, alpha=0.8)...
2025-12-26 21:21:06,669 | INFO     | inlp_core.py:get_projection_and_svm:42 | Iter 1: SVM Acc = 0.6612
2025-12-26 21:21:06,875 | INFO     | inlp_core.py:get_projection_and_svm:42 | Iter 2: SVM Acc = 0.6529
2025-12-26 21:21:06,994 | INFO     | inlp_core.py:get_projection_and_svm:42 | Iter 3: SVM Acc = 0.6513
2025-12-26 21:21:07,144 | INFO     | inlp_core.py:get_projection_and_svm:42 | Iter 4: SVM Acc = 0.6516
2025-12-26 21:21:07,152 | INFO     | inlp_core.py:get_projection_and_svm:75 | 
--- Projection Matrix Analysis ---
2025-12-26 21:21:07,153 | INFO     | inlp_core.py:get_projection_and_svm:78 | Projection matrix rank: 64/64
2025-12-26 21:21:07,153 | INFO     | inlp_core.py:get_projection_and_svm:79 | ==================================================
2025-12-26 21:21:07,160 | INFO     | stage1_bias_analysis.py:main:546 | 
--- EVALUATING GENDER INFORMATION (SVM) ---
2025-12-26 21:21:07,187 | INFO     | stage1_bias_analysis.py:main:557 | Gender SVM Accuracy (Before Projection):
2025-12-26 21:21:07,187 | INFO     | stage1_bias_analysis.py:main:558 |    Train: 67.6848%
2025-12-26 21:21:07,188 | INFO     | stage1_bias_analysis.py:main:559 |    Test:  66.3462% (Indicates bias presence)
2025-12-26 21:21:07,188 | INFO     | stage1_bias_analysis.py:main:560 |    Test Female (class 0): 76.4940%
2025-12-26 21:21:07,188 | INFO     | stage1_bias_analysis.py:main:561 |    Test Male (class 1):   61.2823%
2025-12-26 21:21:07,205 | INFO     | stage1_bias_analysis.py:main:572 | 
--- Activation Statistics (After Projection) ---
2025-12-26 21:21:07,205 | INFO     | stage1_bias_analysis.py:main:573 | Train activations (projected) shape: (24128, 64)
2025-12-26 21:21:07,220 | INFO     | stage1_bias_analysis.py:main:574 | Train activations (projected) - Mean: 0.000049, Std: 0.120319
2025-12-26 21:21:07,221 | INFO     | stage1_bias_analysis.py:main:575 | Train activations (projected) - L2 norm: 149.515318
2025-12-26 21:21:07,221 | INFO     | stage1_bias_analysis.py:main:576 | Test activations (projected) shape: (6032, 64)
2025-12-26 21:21:07,221 | INFO     | stage1_bias_analysis.py:main:577 | Test activations (projected) - L2 norm: 75.290739
2025-12-26 21:21:07,225 | INFO     | stage1_bias_analysis.py:main:584 | Train activation norm change: 220.670792 -> 149.515318 (-32.25%)
2025-12-26 21:21:07,226 | INFO     | stage1_bias_analysis.py:main:585 | Test activation norm change: 110.669044 -> 75.290739 (-31.97%)
2025-12-26 21:21:07,226 | INFO     | stage1_bias_analysis.py:main:586 | ================================================================================
2025-12-26 21:21:07,237 | INFO     | stage1_bias_analysis.py:main:595 | Gender SVM Accuracy (After Projection):
2025-12-26 21:21:07,237 | INFO     | stage1_bias_analysis.py:main:596 |    Train: 67.7470%
2025-12-26 21:21:07,237 | INFO     | stage1_bias_analysis.py:main:597 |    Test:  66.4954% (Should be ~50% if successful)
2025-12-26 21:21:07,237 | INFO     | stage1_bias_analysis.py:main:598 |    Test Female (class 0): 76.3944%
2025-12-26 21:21:07,237 | INFO     | stage1_bias_analysis.py:main:599 |    Test Male (class 1):   61.5557%
2025-12-26 21:21:07,237 | INFO     | stage1_bias_analysis.py:main:604 | 
--- APPLYING WEIGHT SURGERY ---
2025-12-26 21:21:07,237 | INFO     | inlp_core.py:perform_weight_surgery:93 | 
--- Performing Weight Surgery ---
2025-12-26 21:21:07,275 | INFO     | inlp_core.py:perform_weight_surgery:102 | W_old shape: torch.Size([1, 64]), norm: 1.889688
2025-12-26 21:21:07,276 | INFO     | inlp_core.py:perform_weight_surgery:103 | P_tensor shape: torch.Size([64, 64]), norm: 7.849151
2025-12-26 21:21:07,277 | INFO     | inlp_core.py:perform_weight_surgery:104 | P_tensor symmetry error: 4.58e-01
2025-12-26 21:21:07,315 | INFO     | inlp_core.py:perform_weight_surgery:117 | Weights updated successfully. W_new shape: torch.Size([1, 64]), norm: 1.037146
2025-12-26 21:21:07,316 | INFO     | inlp_core.py:perform_weight_surgery:118 | Weight change magnitude: 1.516093
2025-12-26 21:21:07,318 | INFO     | inlp_core.py:perform_weight_surgery:138 | Bias updated to account for data centering.
2025-12-26 21:21:07,318 | INFO     | inlp_core.py:perform_weight_surgery:139 |   Bias correction magnitude: 2.153429, Bias norm: 0.006265 -> 2.147164
2025-12-26 21:21:07,325 | INFO     | stage1_bias_analysis.py:main:610 | Repaired Model saved to: /home/arjun/remote_github/Fairness_Testing/Fairness_Neuron_Repair/ml_models/adult/adult__nn_stage1_inlp_repaired__20251226_21_17_58.pth
2025-12-26 21:21:07,325 | INFO     | stage1_bias_analysis.py:main:615 | 
--- FINAL EVALUATION (After Surgery) ---
2025-12-26 21:21:07,336 | INFO     | stage1_bias_analysis.py:main:628 | Final Income Accuracy: 71.3031%
2025-12-26 21:21:07,336 | INFO     | stage1_bias_analysis.py:main:629 | Accuracy Drop: 11.7042%
2025-12-26 21:21:07,338 | INFO     | stage1_bias_analysis.py:main:638 | Final Accuracy (Class 0): 62.7676% (4531 samples)
2025-12-26 21:21:07,339 | INFO     | stage1_bias_analysis.py:main:641 | Final Accuracy (Class 1): 97.0686% (1501 samples)
2025-12-26 21:21:07,360 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-26 21:21:07,363 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-26 21:21:07,363 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-26 21:21:07,374 | INFO     | preprocess.py:patch_test_categories:188 | Column native-country has 2 categories in training data that are missing in test data
2025-12-26 21:21:07,377 | INFO     | preprocess.py:patch_test_categories:202 | Added 2 dummy rows to test data for categories missing in test set
2025-12-26 21:21:07,377 | INFO     | preprocess.py:patch_test_categories:204 |   - native-country: 2 categories
2025-12-26 21:21:07,661 | INFO     | stage1_bias_analysis.py:main:650 | Final Counterfactual Discrimination: 516/6032 (8.55%)
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:658 | Final AOD: 0.185348
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:659 | Final EOD: 0.069641
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:680 | 
Improvement Ratios:
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:682 |   Accuracy Change Ratio: 14.10%
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:687 |   Discrimination Change Ratio: 15.82%
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:697 | 
================================================================================
2025-12-26 21:21:07,683 | INFO     | stage1_bias_analysis.py:main:698 | SUMMARY (Requested Ordering)
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:699 | Before fix:
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:700 |   Accuracy: 83.0073%
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:701 |   Classwise Accuracy (Class 0): 83.3591%
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:702 |   Classwise Accuracy (Class 1): 81.9454%
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:703 |   Avg Prob (Pred Class 0): 0.128873
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:704 |   Avg Prob (Pred Class 1): 0.768778
2025-12-26 21:21:07,684 | INFO     | stage1_bias_analysis.py:main:705 |   SVM Accuracy (Gender) Test: 66.3462%
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:706 |   SVM Classwise Accuracy (Female): 76.4940%
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:707 |   SVM Classwise Accuracy (Male):   61.2823%
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:708 |   Counterfactual Fairness (Discrimination %): 10.16%
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:709 |   AOD: 0.130832
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:710 |   EOD: 0.088828
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:712 | After fix:
2025-12-26 21:21:07,685 | INFO     | stage1_bias_analysis.py:main:713 |   Accuracy: 71.3031%
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:714 |   Classwise Accuracy (Class 0): 62.7676%
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:715 |   Classwise Accuracy (Class 1): 97.0686%
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:716 |   Avg Prob (Pred Class 0): 0.306564
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:717 |   Avg Prob (Pred Class 1): 0.675265
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:718 |   SVM Accuracy (Gender) Test: 66.4954%
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:719 |   SVM Classwise Accuracy (Female): 76.3944%
2025-12-26 21:21:07,686 | INFO     | stage1_bias_analysis.py:main:720 |   SVM Classwise Accuracy (Male):   61.5557%
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:721 |   Counterfactual Fairness (Discrimination %): 8.55%
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:722 |   AOD: 0.185348
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:723 |   EOD: 0.069641
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:725 | Change before and after fix:
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:726 |   Accuracy (% change): -14.10%
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:727 |   Class 0 Accuracy (% change): -24.70%
2025-12-26 21:21:07,687 | INFO     | stage1_bias_analysis.py:main:728 |   Class 1 Accuracy (% change): 18.46%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:729 |   Avg Prob (Pred Class 0) (% change): 137.88%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:730 |   Avg Prob (Pred Class 1) (% change): -12.16%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:731 |   SVM Accuracy (% change): 0.22%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:732 |   SVM Female (% change): -0.13%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:733 |   SVM Male (% change):   0.45%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:734 |   Counterfactual Fairness (Discrimination %) (% change): -15.82%
2025-12-26 21:21:07,688 | INFO     | stage1_bias_analysis.py:main:735 |   AOD (% change): 41.67%
2025-12-26 21:21:07,689 | INFO     | stage1_bias_analysis.py:main:736 |   EOD (% change): -21.60%
2025-12-26 21:21:07,689 | INFO     | stage1_bias_analysis.py:main:737 | ================================================================================
2025-12-26 21:21:07,689 | INFO     | stage1_bias_analysis.py:main:779 | Process end time: 2025-12-26 21:21:07
2025-12-26 21:21:07,689 | INFO     | stage1_bias_analysis.py:main:780 | Total execution time: 3 minutes 8 seconds (188.77 seconds)
2025-12-26 21:21:07,689 | INFO     | stage1_bias_analysis.py:main:781 | ================================================================================
